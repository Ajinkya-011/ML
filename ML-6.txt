!pip install mlxtend
Requirement already satisfied: mlxtend in /usr/local/lib/python3.10/dist-packages (0.22.0)
Requirement already satisfied: scipy>=1.2.1 in /usr/local/lib/python3.10/dist-packages (from mlxtend) (1.11.3)
Requirement already satisfied: numpy>=1.16.2 in /usr/local/lib/python3.10/dist-packages (from mlxtend) (1.23.5)
Requirement already satisfied: pandas>=0.24.2 in /usr/local/lib/python3.10/dist-packages (from mlxtend) (1.5.3)
Requirement already satisfied: scikit-learn>=1.0.2 in /usr/local/lib/python3.10/dist-packages (from mlxtend) (1.2.2)
Requirement already satisfied: matplotlib>=3.0.0 in /usr/local/lib/python3.10/dist-packages (from mlxtend) (3.7.1)
Requirement already satisfied: joblib>=0.13.2 in /usr/local/lib/python3.10/dist-packages (from mlxtend) (1.3.2)
Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from mlxtend) (67.7.2)
Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.0.0->mlxtend) (1.1.1
Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.0.0->mlxtend) (0.12.0)
Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.0.0->mlxtend) (4.43
Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.0.0->mlxtend) (1.4.
Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.0.0->mlxtend) (23.2)
Requirement already satisfied: pillow>=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.0.0->mlxtend) (9.4.0)
Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.0.0->mlxtend) (3.1.1
Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.0.0->mlxtend) (2
Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=0.24.2->mlxtend) (2023.3.post1
Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn>=1.0.2->mlxtend)
Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.7->matplotlib>=3.0.0->m
import csv
from mlxtend.preprocessing import TransactionEncoder
from mlxtend.frequent_patterns import apriori,association_rules
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
import pandas as pd
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
df=pd.read_csv('/content/Market_Basket_Optimisation.csv')
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
dataset=[]
with open("/content/Market_Basket_Optimisation.csv") as file:
reader=csv.reader(file,delimiter=',')
for row in reader:
dataset+=[row]
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
print("The DataSet is:")
dataset
10/10/23, 12:39 PM ML6.ipynb - Colaboratory
https://colab.research.google.com/drive/1bupUiF1zh8AMxZwxjQ-2msHDT8BYypwT#scrollTo=QM4_MkDHNsDs&printMode=true 2/4
 'zucchini',
 'green tea'],
['shrimp',
 'spaghetti',
 'mineral water',
 'soup',
 'milk',
 'olive oil',
 'chicken',
 'cake',
 'burger sauce',
 'oil'],
['chicken', 'cooking oil', 'tea'],
['burgers',
 'soup',
 'vegetables mix',
 'pancakes',
 'body spray',
 'melons',
 'protein bar',
 'asparagus',
 'mayonnaise',
 'mint',
 'green tea'],
['shrimp', 'pepper'],
['spaghetti', 'olive oil', 'blueberries'],
['muffins'],
['grated cheese', 'herb & pepper', 'muffins', 'eggs', 'low fat yogurt'],
['grated cheese',
 'frozen vegetables',
 'spaghetti',
 'milk',
te=TransactionEncoder()
x=te.fit_transform(dataset)
#for converting dataset into structured list form TransactionEncoder is used
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
print("The structured list is:\n")
x
The structured list is:
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
array([[False, True, True, ..., True, False, False],
 [False, False, False, ..., False, False, False],
 [False, False, False, ..., False, False, False],
 ...,
 [False, False, False, ..., False, False, False],
 [False, False, False, ..., False, False, False],
 [False, False, False, ..., False, True, False]])
len(te.columns_)
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
120
df=pd.DataFrame(x,columns=te.columns_)
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
print("Printing firset 10 rows of Structured Dataset:")
df.head()
#trasaction Encoding required for Association rule
10/10/23, 12:39 PM ML6.ipynb - Colaboratory
https://colab.research.google.com/drive/1bupUiF1zh8AMxZwxjQ-2msHDT8BYypwT#scrollTo=QM4_MkDHNsDs&printMode=true 3/4
Printing firset 10 rows of Structured Dataset:
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_c
 and should_run_async(code)
asparagus almonds antioxydant
juice asparagus avocado babies
food bacon barbecue
sauce
black
tea blueberries body
spray
bramble brownies bug
spray
0 False True True False True False False False False False False False False False
1 False False False False False False False False False False False False False False
2 False False False False False False False False False False False False False False
3 False False False False True False False False False False False False False False
4 False False False False False False False False False False False False False False
5 rows × 120 columns
#hyper Parameters
#parameters which are passed by us to model
frequency_items=apriori(df,min_support=0.01,use_colnames=True)
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning
 and should_run_async(code)
support itemsets
0 0.020397 (almonds)
1 0.033329 (avocado)
2 0.010799 (barbecue sauce)
3 0.014265 (black tea)
4 0.011465 (body spray)
... ... ...
252 0.011065 (milk, ground beef, mineral water)
253 0.017064 (ground beef, spaghetti, mineral water)
254 0.015731 (milk, spaghetti, mineral water)
255 0.010265 (olive oil, spaghetti, mineral water)
256 0.011465 (spaghetti, pancakes, mineral water)
257 rows × 2 columns
frequency_items
#Find the rules
rules=association_rules(frequency_items,metric='confidence',
min_threshold=0.25)
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
rules=rules[['antecedents','consequents','support','confidence']]
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
print("The Association Rule is:\n")
rules.head()
10/10/23, 12:39 PM ML6.ipynb - Colaboratory
https://colab.research.google.com/drive/1bupUiF1zh8AMxZwxjQ-2msHDT8BYypwT#scrollTo=QM4_MkDHNsDs&printMode=true 4/4
The Association Rule is:
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_c
 and should_run_async(code)
antecedents consequents support confidence
0 (avocado) (mineral water) 0.011598 0.348000
1 (burgers) (eggs) 0.028796 0.330275
2 (burgers) (french fries) 0.021997 0.252294
3 (burgers) (mineral water) 0.024397 0.279817
4 (cake) (mineral water) 0.027463 0.338816
filtered_rules = rules[rules['antecedents'].apply(lambda x: 'cake' in x)]
consequents_column = filtered_rules['consequents']
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_
 and should_run_async(code)
/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py:283: DeprecationWarning: `should_run_async` will not call `transform_c
 and should_run_async(code)
antecedents consequents support confidence
4 (cake) (mineral water) 0.027463 0.338816